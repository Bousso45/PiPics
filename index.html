<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>PiPics Game</title>
  <link rel="stylesheet" href="style.css" />
  <!-- Pi Network SDK -->
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  <script>
    Pi.init({ version: "2.0" });
  </script>
</head>
<body>

  <!-- üíú PiPics Difficulty Selection Screen -->
  <div id="difficulty-screen" class="screen active">
    <div class="logo">‚Äß‚ÇäÀö‚úß PiPics ‚úßÀö‚Çä‚Äß</div>
    <div class="sound-toggle" id="sound-toggle" title="Toggle sound">üîä</div>

    <!-- Add Pi Network Auth Button -->
    <div id="pi-auth-container" class="pi-auth-container">
      <button id="pi-auth-button" class="pi-auth-btn">
        <img src="https://minepi.com/favicon.ico" alt="Pi Logo" class="pi-logo">
        Sign in with Pi
      </button>
      <div id="pi-user-info" class="pi-user-info" style="display: none;">
        <img id="pi-user-avatar" class="pi-avatar" src="">
        <span id="pi-username"></span>
      </div>
    </div>

    <h2 class="select-title">Choose Your Pi Path</h2>
    <div class="difficulty-options">
      <button class="difficulty-btn" data-mode="easy">ü•ú Pi-nuts</button>
      <button class="difficulty-btn" data-mode="medium">üöÄ Pi-oneer</button>
      <button class="difficulty-btn" data-mode="hard">üß† Pi-brain</button>
    </div>
  </div>

  <!-- üî• Game Screen -->
  <div id="game-screen" class="screen">
      <div class="game-container centered">

      <!-- Top Bar - Add Pi User Info -->
      <div class="top-bar">
        <button class="back-btn" id="back-button" title="Back to menu">ü†à Back</button>
        <div class="level-badge" id="level-number">1</div>
        <div class="coin-counter">
          <img src="coin.png" class="coin-icon" />
          <span id="coin-count">314</span>
          <span class="coin-plus">+</span>
        </div>
        <div id="game-pi-user" class="pi-game-user" style="display: none;">
          <img id="game-user-avatar" class="pi-avatar" src="">
        </div>
      </div>

      <!-- Image Grid -->
      <div class="image-grid">
        <img src="https://picsum.photos/id/101/200/200" class="game-image" />
        <img src="https://picsum.photos/id/102/200/200" class="game-image" />
        <img src="https://picsum.photos/id/103/200/200" class="game-image" />
        <img src="https://picsum.photos/id/104/200/200" class="game-image" />
      </div>

      <!-- Answer Boxes -->
      <div class="answer-boxes" id="answer-boxes">
        <div class="answer-letter"></div>
        <div class="answer-letter"></div>
        <div class="answer-letter"></div>
        <div class="answer-letter"></div>
        <div class="answer-letter"></div>
      </div>

      <!-- Letter Buttons & Hint/Delete/Skip -->
      <div class="letters-container">

        <!-- Row 1: Letters + Hint -->
        <div class="letters-row" id="letters-row-1">
          <button class="letter-btn">A</button>
          <button class="letter-btn">B</button>
          <button class="letter-btn">C</button>
          <button class="letter-btn">D</button>
          <button class="letter-btn">E</button>
          <button class="letter-btn">F</button>
          <button class="hint-btn" id="hint-button" title="Hint">
            <img src="hint.png" alt="Hint" />
            <span class="cost">30</span>
          </button>
        </div>

        <!-- Row 2: Letters + Delete -->
        <div class="letters-row" id="letters-row-2">
          <button class="letter-btn">G</button>
          <button class="letter-btn">H</button>
          <button class="letter-btn">I</button>
          <button class="letter-btn">J</button>
          <button class="letter-btn">K</button>
          <button class="letter-btn">L</button>
          <button class="delete-btn" id="delete-button" title="Delete">
            <img src="delete.png" alt="Delete" />
            <span class="cost">80</span>
          </button>
        </div>

        <!-- Skip Button Row -->
        <div class="skip-btn" title="Skip this level (100 coins)"> SKIP ‚è≠</div>

      </div>

    </div>
  </div>

  <!-- üîä Sounds -->
  <audio id="success-sound" src="success.mp3" preload="auto"></audio>
  <audio id="error-sound" src="error.mp3" preload="auto"></audio>
  <audio id="transition-sound" src="transition.mp3" preload="auto"></audio>
  <audio id="tap-sound" src="tap.wav"></audio>
  <audio id="remove-sound" src="remove.wav"></audio>
  <audio id="hint-sound" src="hint.wav"></audio>
  <audio id="delete-sound" src="delete.wav"></audio>
  <audio id="select-sound" src="select.wav" preload="auto"></audio>

  <!-- üìú Script -->
  <script src="script.js"></script>

  <!-- Initialize Pi SDK -->
  <script>
    // Initialize Pi Network SDK
    Pi.init({ version: "2.0", sandbox: false });

    // Auth button click handler
    document.getElementById('pi-auth-button').addEventListener('click', function() {
      Pi.authenticate(['username', 'payments', 'wallet_address'], function(auth) {
        // Success callback
        console.log('Pi Auth successful', auth);

        // Hide auth button and show user info
        document.getElementById('pi-auth-button').style.display = 'none';
        const userInfo = document.getElementById('pi-user-info');
        userInfo.style.display = 'flex';

        // Set user info
        document.getElementById('pi-username').textContent = auth.user.username;
        document.getElementById('pi-user-avatar').src = auth.user.avatar;

        // Also show user in game screen
        const gameUser = document.getElementById('game-pi-user');
        gameUser.style.display = 'flex';
        document.getElementById('game-user-avatar').src = auth.user.avatar;

        // You can now use auth.accessToken for backend API calls
        // and auth.user for user information

      }, function(error) {
        // Error callback
        console.error('Pi Auth error', error);
        alert('Pi Network authentication failed: ' + error.message);
      });
    });
  </script>
</body>
</html>
